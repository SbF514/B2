services:
  # Service 1: The Trading Bot (Background Worker)
  - type: worker
    name: binance-bot-worker
    env: docker
    region: frankfurt # EU Central
    plan: starter
    dockerCommand: python -m binance_trade_bot
    envVars: &common-env
      - key: PYTHONUNBUFFERED
        value: "1"
      - key: BRIDGE_SYMBOL
        value: USDT
      - key: TLD
        value: com
      - key: SCOUT_SLEEP_TIME
        value: "60"
      - key: DRY_RUN
        value: "True"
      # Database connection (Required for sharing data between Worker and API)
      - key: DATABASE_URL
        sync: false
      # API Keys
      - key: API_KEY
        sync: false
      - key: API_SECRET_KEY
        sync: false

  # Service 2: The API Server (For Vercel Dashboard)
  - type: web
    name: binance-bot-api
    env: docker
    region: frankfurt
    plan: starter
    dockerCommand: python -m binance_trade_bot.api_server
    envVars: *common-env # Inherits all variables above
    healthCheckPath: /api/ping
